<html>
  <head>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="position-container">
      <h3>Position Type</h3>
      <div class="position-buttons">
        <a class="job-button" href="#">Full-Time</a>
        <a class="job-button" href="#">Part-Time</a>
      </div>
    </div>
    <div class="position-container">
      <h3>Major</h3>
      <div class="position-buttons">
        <a
          onClick="getJobs(`https://kent.joinhandshake.com/external_feeds/13985/public.rss?token=tpYCb6ByHZRHek8jKAzoGulYcDfMydo-s24Aoz0K6P4JrqY9-lHVkg`)"
          id="emat"
          class="job-button"
          >EMAT</a
        >
        <a class="job-button" href="#">COMM</a>
        <a class="job-button" href="#">COMM</a>
        <a class="job-button" href="#">COMM</a>
        <a class="job-button" href="#">COMM</a>
        <a class="job-button" href="#">COMM</a>
      </div>
    </div>
    <div class="display-jobs"></div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <script>
      var rssDefault = `https://kent.joinhandshake.com/external_feeds/13985/public.rss?token=tpYCb6ByHZRHek8jKAzoGulYcDfMydo-s24Aoz0K6P4JrqY9-lHVkg`;

      window.onload = getJobs(rssDefault);

      function getJobs(rss) {
        $.ajax({
          url: "https://api.rss2json.com/v1/api.json",
          method: "GET",
          dataType: "json",
          data: {
            rss_url: rss,
          },
        }).done(function (response) {
          if (response.status != "ok") {
            throw response.message;
          }

          console.log("====== " + response.feed.title + " ======");

          for (var i in response.items) {
            var displayJobs =
              document.getElementsByClassName("display-jobs")[0];
            var item = response.items[i];
            var div = document.createElement("div");
            displayJobs.appendChild(div);
            div.classList = "job-container";
            var titleLink = document.createElement("a");
            var title = document.createElement("h2");
            title.innerHTML = item.title;
            titleLink.appendChild(title);
            titleLink.href = item.link;
            titleLink.target = "_blank";
            div.appendChild(titleLink);

            var split = item.description.split("Employer:");
            var employer = split[1].split("Expires:");
            var employerElement = document.createElement("p");
            var date = employer[1].split("\n\n");
            var dateElement = document.createElement("p");
            dateElement.innerHTML = date[0];
            // var description = document.createElement('p')
            var descriptionContainer = document.createElement("div");
            var shortDescriptionContent = date[1].slice(0, 360);
            var longDescriptionContent = date[1].slice(360);
            var shortDescription = document.createElement("p");
            var descriptionBreak = document.createElement("span");
            var longDescription = document.createElement("span");
            descriptionBreak.appendChild(
              document.createTextNode("... Read More")
            );
            descriptionBreak.classList = "show";

            shortDescription.appendChild(
              document.createTextNode(shortDescriptionContent)
            );
            descriptionContainer.appendChild(shortDescription);
            descriptionContainer.classList = "description-container";
            longDescription.appendChild(
              document.createTextNode(longDescriptionContent)
            );
            longDescription.classList = "long-description hide";
            shortDescription.appendChild(descriptionBreak);
            shortDescription.appendChild(longDescription);
            // description.innerHTML = date[1]
            console.log(date);
            employerElement.innerHTML = employer[0];
            div.appendChild(employerElement);
            div.appendChild(dateElement);
            div.appendChild(descriptionContainer);

            var button = document.createElement("a");
            button.appendChild(document.createTextNode("View on HandShake"));
            button.href = item.link;
            button.target = "_blank";
            div.appendChild(button);

            console.log(item);
          }
        });
      }
    </script>
  </body>
</html>
